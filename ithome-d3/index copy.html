<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
    </head>
    <body>
        <!-- <p class="enterData">data</p>
        <p class="enterData">data</p>

        <svg width="400" height="200" style="border:1px solid tomato">
            <rect
                x="25"
                y="30"
                width="300"
                height="100"
                style="fill:rgb(0, 195, 255); stroke-width:3; stroke:rgb(0,0,0)"
            />
        </svg>
        <svg width="400" height="150" style="border:1px solid tomato">
            <circle cx="100" cy="50" r="40" stroke="black" stroke-width="3" fill="red" />
        </svg>

        <svg width="400" height="150" style="border:1px solid tomato">
            <ellipse cx="200" cy="80" rx="80" ry="50" stroke="black" stroke-width="3" fill="pink"></ellipse>
        </svg>
        <svg width="400" height="200" style="border:1px solid tomato">
            <line x1="0" y1="0" x2="200" y2="200" style="stroke:rgb(0,0,255); stroke-width:2" />
        </svg>
        <svg width="400" height="200" style="border:1px solid tomato">
            <polyline
                points="20,50 40,25 60,40 80,120 120,140 160,180 "
                style="fill: none; stroke: orangered; stroke-width: 3"
            />
        </svg>
        <svg width="400" height="200" style="border:1px solid tomato">
            <polygon points="200,10 250,190 160,180" style="fill: lime; stroke: purple; stroke-width: 1" />
        </svg>
        <svg class="svg1" width="500" height="300" style="border:1px solid tomato">
            <circle></circle>
        </svg> -->

        <svg class="line" style="border:1px solid skyblue"></svg>

        <svg class="area" style="border:1px solid skyblue"></svg>

        <svg class="arc" style="border:1px solid skyblue"></svg>

        <svg class="axis" style="border:1px solid skyblue"></svg>

        <svg class="stack" style="border:1px solid skyblue"></svg>

        <script src="https://d3js.org/d3.v7.min.js"></script>
        <script>
            d3.select('.svg1 circle')
              .attr("r", 10)
              .attr("fill", "blue")
              .attr("cx", 50)
              .attr("cy", 50)
              .attr("transform", "translate(40,40)");

            const enterData = ["資", "料", "比", "較", "多"];
            const eData = d3.selectAll('.enterData')
              .data(enterData)
              .enter()
              .append('p')
              .attr('class', 'enterData')

            // Line Generator
            const data1 = [{x:10,y:10},{x:20,y:10},{x:30,y:10},{x:40,y:10},{x:50,y:10}]

            const line = d3.line()
               .x(d=> d.x) // 設定x值要抓哪些資料
               .y(d=> d.y) // 設定y值要抓哪些資料

            d3.select('.line')
              .append('path')
              .attr('d', line(data1))
              .attr('stroke', 'black')
              .attr('stroke-width', '2')
              .attr('fill', 'none')

            const data2 = [{x:10,y:100},{x:20,y:100},{x:30,y:100},{x:90,y:20},{x:220,y:10}]

            const area = d3.area()
              .x(d => d.x)
              .y1(d => d.y)
              .y0(10)

            d3.select('.area')
              .append('path')
              .attr('d', area(data2))
              .attr('stroke', 'skyblue')
              .attr('fill', 'skyblue')

            const arc = d3.arc()
              .innerRadius(40) // 內圈範圍 40
              .outerRadius(50) // 外圈範圍 50
              .startAngle(Math.PI * 1.2)
              .endAngle(Math.PI * 2.8)

            d3.select('.arc')
              .append('g')
              .attr('transform', 'translate(100, 100)') // 把整個圓弧移動到 100,100 的位置
              .append('path')
              .attr('d', arc())
              .attr('stroke', 'skyblue')
              .attr('fill', 'skyblue')

            const data3 = [{x:10,y:100},{x:20,y:100},{x:30,y:100},{x:90,y:20},{x:220,y:10}]

            // 抓出 x 軸要使用的值
            const xData = data3.map((i) => i.x)

            // 設定 x 軸的比例尺與繪製範圍
            const xScale = d3.scaleLinear()
              .domain([0, d3.max(xData)])
              .range([10, 290])

            //使用 xScale 的設定，繪製刻度(ticks)朝下的軸線
            const xAxis = d3.axisBottom(xScale)

            // 呼叫軸線
            d3.select('.axis')
              .append('g')
              .call(xAxis)
              .attr('transform', 'translate(0, 130)')

            // stack =================================================================
            const dataStack = [
              {month: new Date(2021, 0, 1), China: 32, America: 20, Taiwan: 30},
              {month: new Date(2021, 1, 1), China: 7, America: 27, Taiwan: 18},
              {month: new Date(2021, 2, 1), China: 13, America: 33, Taiwan: 18},
              {month: new Date(2021, 3, 1), China: 6, America: 18, Taiwan: 20}
            ];

            const stack = d3.stack()
              .keys(['China', 'America', 'Taiwan']) // 設定資料的keys

            const stackedSeries = stack(dataStack) // 把資料帶入stack方法

            // 顏色
            const colorScale = d3.scaleOrdinal()
              .domain(['China', 'America', 'Taiwan'])
              .range(['red', 'blue', 'orange'])

            // 建立集合元素g、設定顏色
            const g = d3.select('.stack')
              .attr('width', 300)
              .selectAll('g')
              .data(stackedSeries)
              .enter()
              .append('g')
              .attr('fill', d => colorScale(d.key))

            // 繪製長條圖
            g.selectAll('rect')
              .data(d => d)
              .join('rect')
              .attr('width', d => d[1] - d[0]) // 長度為終點值減掉起始值
              .attr('x', d => d[0]) // x 座標設定為起始值
              .attr('y', (d, i) => i * 30) // y座標用 index 來處理，乘上每條 bar 想拉開的距離
              .attr('height', 20)
        </script>
    </body>
</html>
